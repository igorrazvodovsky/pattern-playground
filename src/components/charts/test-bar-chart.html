<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bar Chart Test</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            margin: 2rem;
            background: var(--pp-color-background, #ffffff);
        }
        
        pp-bar-chart {
            width: 100%;
            height: 400px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        
        .test-section {
            margin-bottom: 2rem;
        }
        
        h2 {
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <h1>Bar Chart Component Test</h1>
    
    <div class="test-section">
        <h2>Basic Vertical Bar Chart</h2>
        <pp-bar-chart
            id="basic-chart"
            orientation="vertical"
            show-axes
            show-grid
            animate
        ></pp-bar-chart>
    </div>
    
    <div class="test-section">
        <h2>Horizontal Bar Chart</h2>
        <pp-bar-chart
            id="horizontal-chart"
            orientation="horizontal"
            show-axes
            animate
        ></pp-bar-chart>
    </div>
    
    <script type="module">
        // Mock data for testing
        const sampleData = {
            data: [
                { category: 'Product A', value: 120, color: '#3b82f6' },
                { category: 'Product B', value: 85, color: '#ef4444' },
                { category: 'Product C', value: 150, color: '#10b981' },
                { category: 'Product D', value: 95, color: '#f59e0b' },
                { category: 'Product E', value: 175, color: '#8b5cf6' }
            ],
            xAxisLabel: 'Products',
            yAxisLabel: 'Sales'
        };
        
        const horizontalData = {
            data: [
                { category: 'Q1 2024', value: 85 },
                { category: 'Q2 2024', value: 120 },
                { category: 'Q3 2024', value: 95 },
                { category: 'Q4 2024', value: 140 }
            ],
            orientation: 'horizontal'
        };
        
        // Wait for component to be defined
        customElements.whenDefined('pp-bar-chart').then(() => {
            console.log('Bar chart component is ready');
            
            // Set up basic chart
            const basicChart = document.getElementById('basic-chart');
            if (basicChart) {
                basicChart.data = sampleData;
                basicChart.title = 'Product Sales Data';
                
                // Add event listeners
                basicChart.addEventListener('pp-bar-hover', (e) => {
                    console.log('Bar hovered:', e.detail.data);
                });
                
                basicChart.addEventListener('pp-bar-click', (e) => {
                    console.log('Bar clicked:', e.detail.data);
                });
            }
            
            // Set up horizontal chart
            const horizontalChart = document.getElementById('horizontal-chart');
            if (horizontalChart) {
                horizontalChart.data = horizontalData;
                horizontalChart.title = 'Quarterly Revenue';
            }
        }).catch(error => {
            console.error('Failed to load bar chart component:', error);
            document.body.innerHTML += `
                <div style="background: #fef2f2; border: 1px solid #fecaca; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                    <h3 style="color: #dc2626; margin: 0 0 0.5rem 0;">Component Load Error</h3>
                    <p style="margin: 0; color: #7f1d1d;">The bar chart component failed to load. This might be due to missing D3.js dependencies.</p>
                    <details style="margin-top: 0.5rem;">
                        <summary style="cursor: pointer; color: #991b1b;">Error Details</summary>
                        <pre style="background: #ffffff; padding: 0.5rem; border-radius: 4px; margin-top: 0.5rem; overflow: auto;">${error.message}</pre>
                    </details>
                </div>
            `;
        });
        
        // Import the component (this will fail if D3 dependencies are missing)
        try {
            await import('./pp-bar-chart.js');
        } catch (error) {
            console.error('Import error:', error);
            document.body.innerHTML += `
                <div style="background: #fffbeb; border: 1px solid #fcd34d; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                    <h3 style="color: #d97706; margin: 0 0 0.5rem 0;">Import Warning</h3>
                    <p style="margin: 0; color: #92400e;">Failed to import bar chart component. D3.js dependencies may need to be installed.</p>
                    <p style="margin: 0.5rem 0 0 0; font-size: 0.875rem; color: #78350f;">
                        Required packages: d3-selection, d3-scale, d3-array, d3-transition
                    </p>
                </div>
            `;
        }
    </script>
</body>
</html>